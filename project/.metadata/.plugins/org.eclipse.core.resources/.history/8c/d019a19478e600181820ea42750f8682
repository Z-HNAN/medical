package cn.edu.hdu.zhn.medical.base.service.impl;

import java.util.Date;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import cn.edu.hdu.zhn.medical.base.domain.Bill;
import cn.edu.hdu.zhn.medical.base.domain.Employee;
import cn.edu.hdu.zhn.medical.base.service.IBillService;
import cn.edu.hdu.zhn.medical.base.service.IEmployeeService;
import cn.edu.hdu.zhn.medical.base.util.UserContext;

@Service
public class BillServiceImpl implements IBillService{
	
	@Autowired
	private IEmployeeService employeeService;

	@Override
	public void createBill(Bill br) {
		// 得到这次 请求的员工对象
		Employee employee = this.employeeService.getById(br.getApplier().getId());
		
		Bill bill = new Bill();
		// 将前台传进的值重新封装一次
		bill.setApplier(UserContext.getCurrent());
		bill.setApplyDate(new Date());
		bill.setApplyMoney(br.getApplyMoney());
		bill.setBillState(Bill.BILL_STATE_PENDING);
		bill.setComDeptId(employee.getComDept().getId());
		bill.setDescription(br.getDescription());
		bill.setHospital(br.getHospital());
		bill.setIllnessType(br.getIllnessType());
		bill.setInHospitalDate(br.getInHospitalDate());
		bill.setOutHospitalDate(br.getOutHospitalDate());
		bill.setSeriousType(br.getSeriousType());
	
	}

	
}
